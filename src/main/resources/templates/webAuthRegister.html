<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head th:replace="_header :: header(~{::title})">
  <title>User Register</title>
</head>
<body class="bg-light">

<th:block th:replace="_nav :: nav"/>

<main role="main" class="container" style="padding-top: 50px;">
  <div class="py-5 text-center">
    <p th:if="${validationError}" class="alert alert-danger text-left" th:text="${validationError}">
      validation
      error</p>
  </div>

  <div id="webauthn-register-request" class="card shadow rounded">
    <div class="card-header">
      <h5>1. FIDO認証用情報を要求（ブラウザから認証サーバへ）</h5>
    </div>
    <div class="card-body">
      <p class="card-text">認証サーバへFIDO認証用情報を要求し、チャレンジ等の情報を要求する。</p>
      <div class="card p-3 shadow">
        <form action="#">
          <label class="control-label" for="email">Email </label>
          <input id="email" type="email" class="form-control" placeholder="you@example.com"
                 value="test@test.test"/>
          <div id="emailValidationMessage"></div>
          <button id="webauthn-register-request-btn" class="btn btn-primary mt-3" type="submit">
            FIDO認証情報要求
          </button>
        </form>
      </div>
      <div class="card mt-3 p-3 shadow">
        <div class="form-group">
          <label for="webauthn-register-response">レスポンス</label>
          <textarea class="form-control auto-resize" id="webauthn-register-response" rows="3"
                    readonly></textarea>
        </div>
      </div>
    </div>
  </div>

  <div id="webauthn-register-response-container">
    <input id="webauthn-register-response-json-raw" type="hidden"/>
    <input id="cred-parameter-create-result-json-raw" type="hidden"/>
  </div>

  <div id="cred-parameter-create" class="card mt-5 shadow rounded">
    <div class="card-header">
      <h5>2. 認証機との処理に使用するパラメータの作成</h5>
    </div>
    <div class="card-body">
      <p class="card-text">認証サーバから取得したデータを元にnavigator.credentials.create()呼び出しに必要なパラメータを作成する。</p>
      <div class="card p-3 shadow">
        <form action="#">
          <button id="cred-parameter-create-btn" class="btn btn-primary mt-2" type="submit">
            認証機パラメータ作成
          </button>
        </form>
      </div>
      <div class="card mt-3 p-3 shadow">
        <div class="form-group">
          <label for="webauthn-register-response">結果</label>
          <textarea class="form-control auto-resize" id="cred-parameter-create-result" rows="3"
                    readonly></textarea>
        </div>
      </div>
    </div>
  </div>


  <div id="cred-api-call" class="card mt-5 shadow rounded">
    <div class="card-header">
      <h5>3. navigator.credentials.create()呼び出し</h5>
    </div>
    <div class="card-body">
      <p class="card-text">
        ブラウザから認証機へアクセスするためのブラウザAPI（navigator.credentials.create()）を呼び出し、そのレスポンスを受け取る。</p>
      <div class="card p-3 shadow">
        <form action="#">
          <button id="cred-api-call-btn" class="btn btn-primary mt-2" type="submit">
            ブラウザAPI実行
          </button>
        </form>
      </div>
      <div class="card mt-3 p-3 shadow">
        <div class="form-group">
          <label for="webauthn-register-response">ブラウザAPI返却レスポンス</label>
          <textarea class="form-control auto-resize" id="cred-api-call-result" rows="3"
                    readonly></textarea>
        </div>
      </div>
    </div>
  </div>

</main>

<th:block th:replace="_include :: basic"/>
</body>
</html>